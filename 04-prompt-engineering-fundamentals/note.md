# 提示词工程学习笔记（通用版）

> 面向：初学～进阶开发者 / 产品 / 数据同学  
> 目标：理解什么是提示词工程、常用方法、典型场景与示例

---

## 一、什么是提示词工程？

**定义（实用版）：**  
提示词工程（Prompt Engineering）就是**设计、书写和调优输入给大模型的“指令/话术”**，让模型更稳定、可控地完成你的任务。

可以把大模型当成一个“能力很强但话多的实习生”：

- 能力：会写代码、写文案、总结、翻译、做计划、做分析……
- 问题：
  - 容易发挥过度、答非所问
  - 有时会“瞎编”（幻觉）
  - 输出风格、结构不稳定

**提示词工程的核心目的**是：  
> “把任务说清楚、边界说清楚、格式说清楚，让模型变成一个可控工具，而不是随机聊天对象。”

---

## 二、基础概念：Token、模型与上下文

### 1. Token：计费与长度单位

- 模型看到的不是“字/词”，而是 **token**。
- Token 数影响：
  - 成本（计费按 token）
  - 能处理的最大上下文长度（超了就截断或报错）

**直觉规则：**

- 冗长啰嗦 → token 多 → 成本高、容易超长
- 简洁清晰 → token 少 → 更高效、更容易得到好答案

### 2. 上下文（Context）

- 模型没有“长期记忆”，只能在**本次请求的上下文**里理解你的需求。
- 所有你放进 `messages`、`prompt`、`text` 的内容，都会共同构成“模型眼中的当前世界”。

**启示：**

- 想让它记住什么，就放进上下文；
- 想让它忘掉什么，就别放进本次请求。

---

## 三、提示词工程的常见方式（由浅入深）

### 1. 简单单轮提示（Single-turn Prompting）

**形式：** 一句话/一段话问清楚需求。

**适用：**

- 问答
- 简单改写/翻译
- 简单代码片段生成

**示例：**

```text
你是一名 Python 教师，请用通俗易懂的方式解释什么是「列表推导式」，并给出 2 个简单示例。
要求：
1. 先用生活类比解释；
2. 再给出代码；
3. 代码中添加必要注释。
```

**要点：**

- 明确角色（Python 教师）
- 明确任务（解释 + 示例）
- 列出输出要求（结构化条目）

---

### 2. 指令 + 内容 分离（Instruction + Context）

**典型结构：**

1. 上面是任务说明（你要它做什么）
2. 下面是要处理的原文内容

**适用：**

- 总结、归纳、抽取要点
- 翻译、改写
- 根据文档生成问答、测验题等

**示例：文档总结**

```markdown
你是一名阅读理解老师，请完成以下任务：
1. 用不超过 5 句话总结下面内容的关键观点；
2. 提炼出 3–5 个要点，以 Markdown 列表形式输出。

以下是需要处理的内容：
```TEXT
{在这里粘贴原文内容}
```TEXT
```

**要点：**

- 用明显分隔符（如 ```）包裹原文
- 先说“做什么”，再给“做什么的材料”
- 指定输出形式（要点列表、字数限制等）

---

### 3. 系统提示 + 多轮对话（System + Multi-turn）

现代 API 一般采用 **messages** 模式：`system`、`user`、`assistant`。

- `system`：设定角色、风格、边界  
- `user`：你的提问和指令  
- `assistant`：模型过往的回答（对话历史）

**适用：**

- 聊天机器人 / 顾问助手
- 需要“记住之前聊了什么”的应用
- 需要固定人设、语气、限制行为的场景

**示例：学习教练**

```text
system:
你是一名耐心的学习教练，帮助学生高效学习。
要求：
1. 回答时先用 1–2 句话肯定对方的努力；
2. 再用分点形式给出建议；
3. 如有不确定的地方，要说明“不完全确定”。

user:
我最近在学机器学习，但总觉得理论难、例子少，容易放弃，你能帮我设计一个 2 周的学习计划吗？
```

**要点：**

- `system` 用来“定性”：角色+风格+行为约束
- 复杂对话中，可以把前几轮的关键信息保留在 `assistant` 历史里
- 对安全/合规要求高的领域，在 `system` 中写明“不能做什么”

---

### 4. 示例驱动（Few-shot Prompting）

**思路：** 先给几组“示范输入-输出”，再给新输入，让模型模仿这个模式。

**特别适合：**

- 分类、打标签
- 格式统一（JSON、表格）
- 模仿某种写作/回答风格

**示例：情绪分类**

```text
你是情绪分类器，只能输出：积极、消极、中性。

示例：
文本：这个产品太好用了，用起来非常顺手。
情绪：积极

文本：客服回复太慢了，我等得很烦。
情绪：消极

文本：快递今天到了。
情绪：中性

现在请判断下面这句话的情绪：
文本：{用户输入}
情绪：
```

**要点：**

- 示例要**简洁但有代表性**
- 输出空间越小（例如固定 3 个标签），越容易稳定
- 适合快速做“小型规则系统”，不写代码只写 Prompt

---

### 5. 思维链 / 分步骤推理（Chain-of-Thought）

**核心思想：**  
不直接让模型给结论，而是让它“**先思考步骤，再给答案**”。

**适用：**

- 推理题、计算题
- 多约束决策（择校、选型、投资组合等）
- 复杂逻辑分析（优缺点分析、方案对比）

**示例：选型决策**

```text
你是一名架构师，请根据下面的项目背景，帮我在技术 A 和技术 B 之间做选择。

请严格按照以下步骤回答：
1. 列出项目关键约束条件（如性能、成本、团队经验等）；
2. 对每个约束，对比 A 和 B 的表现，用表格形式呈现；
3. 给出你的结论，并说明理由；
4. 最后给出一个「如果选择另一个方案时，需要满足哪些前提」的建议。

项目背景如下：
```TEXT
{项目描述}
```TEXT
```

**要点：**

- 在提示里显式写出“步骤 1、2、3…”
- 要求输出过程（推理路径），不仅是结论
- 有助于提高推理质量和可解释性

---

### 6. 工具/代码调用（Tool Use / Code Generation）

当模型需要与外部系统互动（查数据库、调用 API、执行代码）时，提示词通常用于：

- 说明“什么时候应该调用工具”
- 告诉它“工具的作用与参数格式”

（这部分在很多框架里由“系统提示 + 工具描述”统一完成，这里点到为止。）

**适用：**

- 检索增强（RAG）
- 代码执行、数据分析
- 业务系统自动化（如调用工单系统、CRM 接口等）

---

## 四、控制“幻觉”与风险

大模型可能会：

- 对不存在的事实编故事
- 对不熟悉的领域装懂
- 在数据要求严格的场景（金额、时间、药物剂量）产生错误

**通过提示进行约束：**

1. **允许“说不知道”**

   ```text
   如果你对某个问题没有把握，或者训练数据中可能缺乏信息，请明确回答“我不知道”或“建议咨询专业人士”，不要编造答案。
   ```

2. **要求区分“事实 / 推测”**

   ```text
   请将回答分为两部分：
   1. 已有可靠资料支持的事实；
   2. 合理推测与假设（请标注为推测）。
   ```

3. **要求引用依据或说明局限**

   ```text
   如涉及统计数据或研究结论，请在回答末尾简要说明数据的大致来源和可能的时间范围。如果无法确定，请说明不确定性。
   ```

**场景建议：**

- 医疗、法律、投资等高风险场景：  
  - 必须在 `system` 中加入“不能提供专业建议，仅供参考”的声明  
  - 引导用户咨询专业人士  
- 面向终端用户的应用：  
  - 通过 UI 再做一层免责声明与约束

---

## 五、不同技术应用下的典型提示策略

### 1. 内容与文案类应用

**场景：** 写文案、改写、总结、生成社交媒体内容

**建议：**

- 明确目标受众（学生、开发者、妈妈群体等）
- 指定语气（正式、幽默、严肃、热情）
- 控制长度（字数/段数）
- 必要时给示例模版

**示例：公众号风格改写**

```text
你是一名新媒体编辑，请把下面的技术文章改写成适合微信公众号的科普文：
要求：
1. 用日常生活类比解释专业概念；
2. 标题要有吸引力，给出 3 个备选；
3. 正文分为 3～5 个小节，每节有小标题；
4. 总字数控制在 1500 字左右。

原文：```{text}```
```

---

### 2. 知识问答与助手类应用

**场景：** FAQ 机器人、学习助手、企业知识库问答

**建议：**

- 在 `system` 中明确数据来源范围（例如仅基于提供的文档）
- 避免模型“瞎编外部知识”：  
  > “如果文档中没有相关信息，请说‘文档中未找到相关内容’。”
- 输出结构化结果（答案 + 参考片段）

**示例：基于文档的问答**

```text
你是一名知识库助手，只能根据「提供的文档内容」回答问题。
要求：
1. 先给出简要回答（不超过 5 句话）；
2. 再列出你参考的文档片段（引用原文或编号）；
3. 如果文档中没有相关信息，请回答“文档中未找到相关内容”。

文档内容：
```DOC
{文档内容}
```DOC

用户问题：{问题}
```

---

### 3. 代码与技术类应用

**场景：** 代码生成、解释代码、重构、写测试

**建议：**

- 指定语言、版本、框架
- 指出运行环境限制（如不能联网）
- 指定输出形式（只代码 / 解释 + 代码分开）

**示例：生成带注释的函数**

```text
你是一名资深 Python 开发者，请根据下面的需求编写函数：
需求：
{需求描述}

要求：
1. 先用 3～5 行说明设计思路；
2. 给出完整的 Python 3.10 兼容代码；
3. 代码中添加必要注释；
4. 不要输出除代码和思路之外的其它文字。
```

---

### 4. 决策与分析类应用

**场景：** 产品方案对比、选型决策、优缺点分析

**建议：**

- 引导分步骤推理（Chain-of-Thought）
- 要求表格输出便于比较
- 区分客观事实与主观判断

**示例：技术选型分析**

```text
你是一名系统架构师，请帮我在技术 A 和技术 B 之间做选择。

请按以下结构输出：
1. 背景理解：用你自己的话简要复述项目需求（不超过 5 句话）；
2. 对比表：从「性能、开发效率、学习成本、生态、运维」5 个维度比较 A 和 B，输出 Markdown 表格；
3. 建议结论：明确给出推荐方案，并说明 2～3 条关键理由；
4. 风险与前提：列出选择该方案时需要注意的风险和前提条件。

项目背景：
```TEXT
{项目描述}
```TEXT
```

---

## 六、实战中的迭代与调优方法

1. **从“能用”到“好用”**

   - 先写出一个简单版本，只保证能完成任务；
   - 根据实际输出，逐步加：
     - 角色设定
     - 输出格式要求
     - 约束与边界说明
     - 示例（few-shot）

2. **错误驱动优化**

   - 每当输出“犯错”，不要只改问题，而是：
     - 把错误类型抽象出来（比如：太长、没列步骤、编造数据）
     - 在提示里增加“反制条件”（例如：限制长度、强制分步骤、要求说明依据）

3. **固定成模板**

   - 对经常用的场景（写周报、写读书笔记、代码 Review、架构分析等），把验证过好用的 Prompt 固定下来；
   - 未来只需要替换变量（文本内容、问题、需求）。

---

## 七、一份可反复使用的通用 Prompt 模板

你可以把下面当“骨架”，按场景填空：

```markdown
你是一名 {角色，例如：资深 Python 工程师 / 产品经理 / 学习教练}，
擅长 {领域，例如：Web 开发 / 文案写作 / 学习规划}。
请根据下面的任务说明完成工作：

【任务目标】
- 用自己的话简单概括你理解的目标：{例如：帮我总结 / 生成文案 / 给出方案对比}

【具体要求】
1. {要求 1，例如：先用 3～5 句话总结要点}
2. {要求 2，例如：再用列表形式给出详细说明}
3. {要求 3，例如：控制在 500 字以内 / 输出为 Markdown 表格}
4. 如有不确定或缺少信息的地方，请明确指出，而不是自行编造。

【待处理内容（如果有）】
```CONTENT
{在这里粘贴原文、需求描述或数据}
```CONTENT
```